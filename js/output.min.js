function initialize(){var e={zoom:11,mapTypeId:google.maps.MapTypeId.Hybrid};map=new google.maps.Map(document.getElementById("map"),e),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){{var o=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);new google.maps.InfoWindow({map:map,position:o,content:"<h3><center>You are here!</center></h3>"})}map.setCenter(o)},function(){handleNoGeolocation(!0)}):handleNoGeolocation(!1)}function handleNoGeolocation(e){if(e)var o="Error: The Geolocation service failed.";else var o="Error: Your browser doesn't support geolocation.";{var n={map:map,position:new google.maps.LatLng(60,105),content:o};new google.maps.InfoWindow(n)}map.setCenter(n.position)}function viewModel(){function e(){$("#query").click(function(){$(this).val("")}),$("#query").blur(function(){""==$(this).val()&&$(this).val("Example: Ninja Japanese Restaurant"),"Example: Ninja Japanese Restaurant"!=$(this).val()?$(this).addClass("focus"):$(this).removeClass("focus")}),$("#searchform").submit(function(e){e.preventDefault(),lat?n():navigator.geolocation.getCurrentPosition(o)})}function o(e){lat=e.coords.latitude,lng=e.coords.longitude,n()}function n(){$.ajax({type:"GET",url:"https://api.foursquare.com/v2/venues/explore?ll="+lat+","+lng+"&client_id=HFOT1XUCTPSBFCWA0W5OMCOLVPWLUA5T0ELRWKDOKAEVRB3V&client_secret=SJRCFDAGLCACDPY1EIEHNITKJIKNCN5KFPOINR0RCPYX35LZ&v=20130619&query="+$("#query").val(),success:function(e){$("#venues").show();var o=e.response.groups[0].items;$("#venues").html("");var n={zoom:11,center:new google.maps.LatLng(33.340053,-111.859627),mapTypeId:google.maps.MapTypeId.HYBRID,panControl:!0,zoomControl:!0},a=new google.maps.Map(document.getElementById("map"),n);$.each(o,function(){this.venue.contact.formattedPhone?(phone="Phone:"+this.venue.contact.formattedPhone,console.log("phone number")):phone="",address=this.venue.location.address?'<p class="subinfo">'+this.venue.location.address+"<br>":"",this.venue.rating&&(rating='<span class="rating">'+this.venue.rating+"</span>"),appendeddatahtml='<div class="venue"><h3><span>'+this.venue.name+rating+"</span></h3>"+address+phone+"</p><p><strong>Total Checkins:</strong> "+this.venue.stats.checkinsCount+"</p></div>",$("#venues").append(appendeddatahtml);{var e={url:"images/ScopePin.png",scaledSize:new google.maps.Size(24,24),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,24)},o={map:a,position:new google.maps.LatLng(this.venue.location.lat,this.venue.location.lng),title:this.venue.name,animation:google.maps.Animation.DROP,icon:e,optimized:!1};new google.maps.Marker(o)}})}})}this.marker=ko.observable(),this.map=ko.observable(),this.lat="",this.lng="",this.appendeddatahtml="",this.arguments="",this.str="",this.newstr="",this.phone="",this.rating="",this.address="",e()}function mapbuild(){$("#venues").hide();{var e={center:new google.maps.LatLng(33.340053,-111.859627),mapTypeId:google.maps.MapTypeId.Hybrid,panControl:!0,zoomControl:!0,tilt:45};new google.maps.Map(document.getElementById("map"),e)}}var map;google.maps.event.addDomListener(window,"load",initialize),google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)}),ko.applyBindings(viewModel),mapbuild();